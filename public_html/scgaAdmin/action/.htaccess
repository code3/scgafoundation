RewriteEngine on

RewriteCond %{REQUEST_URI} !index.php
RewriteCond %{REQUEST_URI} !(.*)/$
RewriteRule ^(.*)$ index.php?p=$1.php [QSA,L]
RewriteRule ^(.*)/$ index.php?p=$1.php [QSA,L]